# Place NetBSD source in ~/netbsd-src
# Place dflybsd source in ~/dragonfly

cp -R ~/dragonfly/sys/vfs/hammer ~/netbsd-src/sys/fs/
#Append hammer to SUBDIR In ~/netbsd-src/sys/fs/Makefile
#Replace <bsd.kmod.mk> by <bsd.kinc.mk> in ~/netbsd-src/sys/fs/hammer/Makefile
cp -R ~/dragonfly/sbin/newfs_hammer ~/netbsd-src/sbin/
#Apennd newfs_hammer to SUBDIR in ~/netbsd-src/sbin/Makefile

cp -R ~/dragonfly/sbin/mount_hammer ~/netbsd-src/sbin/
#Apend mount_hammer to SUBDIR in ~/netbsd-src/sbin/Makefile

cp -R ~/dragonfly/sbin/hammer ~/netbsd-src/sbin/

cp -R ~/dragonfly/lib/libhammer/ ~/netbsd-src/sys/lib/

#XXX Remove PATH changes from Makefiles introduced

#Change ~/netbsd-src/sys/lib/libhammer/libhammer.h,
#	~/netbsd-src/sbin/hammer/hammer_util.h
# to not include <vfs/...> but <fs/...>

#Change ~/netbsd-src/sbin/hammer/ondisk.c 
# to include <sys/disklabel.h> instead of <sys/diskslice.h>
#    include <sys/bootblock.h> instead of <sys/diskmbr.h>

#Add #include <sys/ioctl.h> to ~/netbsd-src/sys/fs/hammer/hammer_ioctl.h

#in ~/netbsd-src/sys/lib/libhammer/misc.c, replace:
#   %s/statfs/statvfs/
#   %s/getfsstat/getvfsstat/

#in ~/netbsd-src/sbin/newfs_hammer/Makefile, :
#add -I${.CURDIR}/../../sys/lib/libhammer.

#in ~/netbsd-src/sys/lib/libhammer/Makefile:
#change -I${.CURDIR}/../../sys to -I${.CURDIR}/../../../sys

#in ~/netbsd-src/sbin/newfs_hammer/newfs_hammer.c
# IOCTLTRIM->MNT_DISCARD

# Future roadblocks:
# Dillon on why porting HAMMER is hard: https://wiki.freebsd.org/PortingHAMMERFS
